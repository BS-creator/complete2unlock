<div class="content-header">
  <div class="container-fluid">
    <div class="row mb-2">
      <div class="col-sm-6">
        <h1 class="m-0 text-dark" translate>EDIT_TITLE</h1>
      </div><!-- /.col -->
      <div class="col-sm-6">
        <ol class="breadcrumb float-sm-right">
          <li class="breadcrumb-item"><a ui-sref="home" translate>NAV_HOME</a></li>
          <li class="breadcrumb-item"><a ui-sref="links" translate>LINKS_TITLE</a></li>
          <li class="breadcrumb-item active" translate>EDIT_TITLE</li>
        </ol>
      </div><!-- /.col -->
    </div><!-- /.row -->
  </div><!-- /.container-fluid -->
</div>


<section class="content">
  <div class="container-fluid">

    <div class="row">
      <div class="col-lg-3 col-6">
        <!-- small box -->
        <div class="small-box bg-info">
          <div class="inner">
            <h3>{{$ctrl.link.views}}</h3>
            <p translate>HOME_LINKS_VIEW</p>
          </div>
          <div class="icon">
            <i class="fa fa-bar-chart" aria-hidden="true"></i>
          </div>
          <a href="#" class="small-box-footer"></a>
        </div>
      </div>
      <!-- ./col -->
      <div class="col-lg-3 col-6">
        <!-- small box -->
        <div class="small-box bg-success">
          <div class="inner">
            <h3>{{$ctrl.link.creditPending | euro}}</h3>
            <p translate>HOME_STATS_CREDIT</p>
          </div>
          <div class="icon">
            <i class="fa fa-credit-card"></i>
          </div>
          <a ui-sref="payout" class="small-box-footer"><span translate>PAYOUT_TITLE</span> <i class="fa fa-arrow-circle-right"></i></a>
        </div>
      </div>
      <!-- ./col -->
      <div class="col-lg-3 col-6">
        <!-- small box -->
        <div class="small-box bg-warning">
          <div class="inner">
            <h3>{{$ctrl.link.completions}}</h3>

            <p translate>HOME_STATS_COMPLETIONS</p>
          </div>
          <div class="icon">
            <i class="fa fa-check"></i>
          </div>
          <a href="#" class="small-box-footer"></a>
        </div>
      </div>
      <!-- ./col -->
      <div class="col-lg-3 col-6">
        <!-- small box -->
        <div class="small-box bg-danger">
          <div class="inner">
            <h3>{{ ('COUNTRY_' + (($ctrl.topCountries[0] || ['NONE'])[0])) | translate}}</h3>

            <p translate>HOME_STATS_COUNTRIES</p>
          </div>
          <div class="icon">
            <i class="fa fa-map-marker"></i>
          </div>
          <a href="#" class="small-box-footer"></a>
        </div>
      </div>

    </div>


    <div class="card">
      <div class="card-body">
        <div class="row">
          <div class="col-md-12">
            <a href="#" ng-click="$ctrl.delete()" class="btn btn-small btn-danger pull-right">{{'EDIT_DELETE' | translate}} <i class="fa fa-trash"></i></a>
            <a href="https://{{$ctrl.link.domain}}/{{$ctrl.link.uniqueId}}" class="btn btn-small btn-primary pull-left">{{'EDIT_PREVIEW' | translate}} <i class="fa fa-eye"></i></a>
            <br>
            <hr>
            <form>
              <h6> <span ng-hide="edit.name">{{$ctrl.link.name}}</span> <input type="text" style="width: 20%; display: inline;" ng-show="edit.name" ng-model="$ctrl.link.name"/> <a ng-click="edit.name = !edit.name" class="btn btn-small btn-warning" data-toggle="modal" data-target="#namelink"> <i class="fa fa-pencil"></i></a> </h6>
              <table class="table table-sm table-striped">
                <tbody>
                  <tr>
                    <th translate>EDIT_HEADING</th>
                    <td><span ng-hide="edit.title">{{$ctrl.link.title}}</span> <input type="text" style="width: 20%; display: inline; min-width: 200px" maxlength="25" ng-show="edit.title" ng-model="$ctrl.link.title"/> <a ng-click="edit.title = !edit.title" data-toggle="modal" data-target="#heading" id="linkHeadingModalTrigger" class="btn btn-small btn-warning" title="Edit heading"> <i class="fa fa-pencil"></i></a></td>
                  </tr>
                  <tr>
                    <th translate>EDIT_BUTTON</th>
                    <td><span ng-hide="edit.buttonText">{{$ctrl.link.buttonText}}</span> <input type="text" style="width: 20%; display: inline; min-width: 200px" maxlength="15" ng-show="edit.buttonText" ng-model="$ctrl.link.buttonText"/> <a ng-click="edit.buttonText = !edit.buttonText" data-toggle="modal" data-target="#blabel" id="linkButtonLabelModalTrigger" class="btn btn-small btn-warning" title="Edit button label"> <i class="fa fa-pencil"></i></a>
                    </td>
                  </tr>
                  <tr>
                    <th translate>EDIT_LOCKEDURL</th>
                    <td><a ng-hide="edit.lockedUrl" href="{{$ctrl.link.lockedUrl}}">{{$ctrl.link.lockedUrl}}</a> <input type="text" style="width: 20%; display: inline; min-width: 200px" ng-show="edit.lockedUrl" ng-model="$ctrl.link.lockedUrl"/> <a ng-click="edit.lockedUrl = !edit.lockedUrl" data-toggle="modal" data-target="#purl" id="linkButtonLabelModalTrigger" class="btn btn-small btn-warning" title="Edit URL"> <i class="fa fa-pencil"></i></a></td>
                  </tr>
                  <tr>
                    <th translate>EDIT_URL</th>
                    <td ng-if="$ctrl.link.shortUrl"><a href="{{$ctrl.link.shortUrl}}">{{$ctrl.link.shortUrl}}</a> <!--<a href="javascript:;" data-toggle="modal" data-target="#curl" id="linkButtonLabelModalTrigger" class="btn btn-small btn-warning" title="Edit URL"> <i class="fa fa-pencil"></i></a>--></td>
                    <td ng-if="!$ctrl.link.shortUrl"><a href="https://{{$ctrl.link.domain}}/{{$ctrl.link.uniqueId}}">https://{{$ctrl.link.domain}}/{{$ctrl.link.uniqueId}}</a> <!--<a href="javascript:;" data-toggle="modal" data-target="#curl" id="linkButtonLabelModalTrigger" class="btn btn-small btn-warning" title="Edit URL"> <i class="fa fa-pencil"></i></a>--></td>
                  </tr>
                  <tr>
                    <th translate>EDIT_MONETIZED</th>
                    <td><input type="checkbox" id="monetized" ng-model="$ctrl.link.monetized"></td>
                  </tr>
                </tbody>
              </table>
            </form>
          </div>
          <div class="col-md-12">
            <h3>Embed Link</h3>
            <textarea readonly><iframe src="https://{{$ctrl.link.domain}}/embed/{{$ctrl.link.uniqueId}}" style="border:none; width: 460px; height: {{341 + $ctrl.link.actions.length * 139 + ($ctrl.link.monetized ? 139 : 0)}}px"></iframe></textarea>
          </div>
          <div class="col-md-12">
            <div class="table-responsive-sm">
              <div class="btn-toolbar">
                <!--<a href="javascript:;" data-toggle="modal" data-target="#addmoreactions" class="btn btn-primary"> <span class="fa fa-plus"></span> Add Action</a> <!--<a href="javascript:;" data-toggle="modal" data-target="#arrange" id="actionReorderModalTrigger"
                  class="btn btn-primary"> <span class="fa fa-sort"></span> Reorder</a>--> </div><br>
              <form ng-submit="$ctrl.addAction(form)" class="table-responsive">
                <table class="table table-sm table-striped">
                  <thead>
                    <tr>
                      <th scope="col" translate>ROTATINGACTION_CHANNEL</th>
                      <th scope="col" translate>HOME_LINKS_ACTIONS</th>
                      <th scope="col" translate>EDIT_ACTION_URL</th>
                      <th scope="col" translate>EDIT_ACTION_CUSTOMCONTENT</th>
                      <th scope="col"></th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr ng-repeat="action in $ctrl.link.actions">
                      <th>{{action.channel | translate}}</th>
                      <th>{{action.action | translate}}</th>
                      <td class="">
                        <a ng-hide="action.edit" href="test">{{action.actionUrl}}</a>
                        <input type="text" ng-show="action.edit" ng-if="action.channel !== 'ROTATINGACTION'"  style="min-width: 200px" ng-model="action.actionUrl" type="text" style="width: 20%; display: inline;"/>
                      </td>
                      <th scope="row">
                        <span ng-hide="action.edit">{{action.customContent}}</span>
                        <input type="text" ng-show="action.edit" ng-model="action.customContent" type="text" style="min-width: 200px display: inline;"/></th>
                      <td class="text-right">
                        <a ng-click="action.edit = !action.edit" href="#" id="linkHeadingModalTrigger" class="btn btn-small btn-warning" title="Edit heading"> <i class="fa fa-pencil"></i></a>
                        <a ng-click="$ctrl.removeAction(action)" class="btn btn-danger btn-small"><span class="fa fa-trash"></span></a>
                      </td>
                    </tr>
                    <tr>
                        <th><select class="form-control" required ng-options="channel as (channel.name | translate) for channel in $ctrl.channels track by channel.name" ng-model="form.channel"></select></th>
                        <th><select class="form-control"  required ng-options="action as (action | translate) for action in form.channel.actions track by action" ng-model="form.action"></select></th>
                      <th><input type="text" required ng-if="form.channel.name !== 'ROTATINGACTION'" style="min-width: 200px" ng-model="form.actionUrl" type="text" /></th>
                      <th><input type="text"  style="min-width: 200px" ng-model="form.customContent" type="text" /></th>
                        <th><button type="submit"  class="btn btn-small btn-primary pull-right"><i class="fa fa-plus"></i> {{' EDIT_ACTION_ADD' | translate}}</button></th>
                    </tr>
                  </tbody>
                </table>
              </form>
              <a href="#" ng-click="$ctrl.save()" class="btn btn-small btn-primary pull-left">{{'EDIT_SAVE' | translate}} <i class="fa fa-floppy-o"></i></a>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
